{% extends 'layout.html' %}

{% block content %}
<link rel="stylesheet" href="/stylesheets/editPost.css">
<div class=".container">
  <h2>Edit Post</h2>
  <form action="/board/{{ notes.id }}" method="POST">
    <!-- 게시물 수정을 위한 폼 요소들 -->
    <label for="content">Content:</label>
    <textarea name="content" id="content" rows="4" required>{{ notes.content }}</textarea>

    <label for="img">Image URL:</label>
    <input type="text" name="img" id="img" value="{{ notes.img }}" required>

    <label for="restaurantName">Restaurant Name:</label>
    <input type="text" name="restaurantName" id="restaurantName" value="{{ notes.restaurantName }}" required>

    <label for="location">Location:</label>
    <input type="text" name="location" id="location" value="{{ notes.location }}" required>

    <label for="category">Category:</label>
    <select name="category" id="category" required>
      <option value="restaurant" {% if notes.category === 'restaurant' %}selected{% endif %}>Restaurant</option>
      <option value="cafe" {% if notes.category === 'cafe' %}selected{% endif %}>Cafe</option>
      <option value="bar" {% if notes.category === 'bar' %}selected{% endif %}>Bar</option>
    </select>

    <label for="rating">Rating:</label>
    <input type="number" name="rating" id="rating" min="0" max="5" step="0.1" value="{{ notes.rating }}" required>

    <button type="submit">Update Post</button>

    <form action="/board/{{ notes.id }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this post?');">
      <input type="hidden" name="_method" value="DELETE">
      <button type="submit" class="delete-button">Delete Post</button>
    </form>
  </form>
</div>

{% endblock %}

{% block script %}
<!-- 클라이언트 측 JavaScript로 삭제 요청을 보내는 함수 -->
<script>
  function deletePost(postId) {
    if (confirm('Are you sure you want to delete this post?')) {
      // 서버로 삭제 요청을 보내는 코드 추가
      fetch(`/board/${postId}`, {
        method: 'DELETE',
      })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            // 삭제 성공 시 페이지 새로고침 또는 리다이렉트 등을 수행
            window.location.href = '/board';
          } else {
            alert('Failed to delete post.');
          }
        })
        .catch(error => {
          console.error('Error deleting post:', error);
          alert('Failed to delete post.');
        });
    }
  }
</script>

{% endblock %}